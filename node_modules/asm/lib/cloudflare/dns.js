var asm = require('../asm'),
    os = require('os'),
    cf = require('cloudflare'),
    ip = require('ip');

asm.createRecord = function () {
    return new Promise(function(resolve, reject) {
        var cloudflare = cf.createClient({
            email: 'cj.sturgess@gmail.com',
            token: '990287e40d8037202c605bdbc6eb2038d764e'
        });
        var host = os.hostname(),
            domain = "anchr.cc",
            options = {
                type: "A",
                name: host,
                content: ip.address()
            };
        cloudflare.addDomainRecord(domain, options, function(err, res) {
            if (err) {
                console.log('An error occurred while creating the A record.'.red);
                reject('Error creating record.');
            } else {
                console.log("[createRecord] Subdomain record created.".green);
                resolve(null);
            }
        });
    });
}