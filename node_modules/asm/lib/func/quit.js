var asm = require('../asm');

asm.quit = function() {
    return new Promise(function(resolve, reject) {
        if (!asm.server.running) {
            console.log("[quit] Server already shut down.".green);
            console.log("[quit] Goodbye world. :(".yellow);
            process.exit(0);
            resolve(null);
        } else {
            console.log("[quit] Nicely shutting down server. :)".green);
            asm.stopServer().then(function(err) {
                if (err) {
                    console.log("[quit] Uh-oh! I ran into an issue while terminating processes...".red);
                    reject('Error');
                } else {
                    console.log("[quit] Server *nicely* shut down. Terminating process.".green);
                    console.log("[quit] Goodbye world. :(".yellow);
                    process.exit(0);
                    resolve(null);
                }
            });
        }
    });
};